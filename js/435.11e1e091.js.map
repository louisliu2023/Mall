{"version":3,"file":"js/435.11e1e091.js","mappings":"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","sources":["webpack://shopvue/./src/views/Comment/index.vue","webpack://shopvue/./src/api/comment.js","webpack://shopvue/./src/components/CommentItem.vue","webpack://shopvue/src/components/CommentItem.vue","webpack://shopvue/./src/components/CommentItem.vue?a0fb","webpack://shopvue/./src/components/CommentItem.vue?0d30","webpack://shopvue/src/views/Comment/index.vue","webpack://shopvue/./src/views/Comment/index.vue?07fa","webpack://shopvue/./src/views/Comment/index.vue?f0bb"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"container\"},[_c('van-nav-bar',{attrs:{\"fixed\":\"\",\"title\":\"商品评价\",\"left-arrow\":\"\"},on:{\"click-left\":function($event){return _vm.$router.back()}}}),_c('van-tabs',{attrs:{\"sticky\":\"\"},on:{\"click\":_vm.changeTab},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('van-tab',{attrs:{\"title\":'全部（' + _vm.commentAll + '）',\"name\":\"-1\"}}),_c('van-tab',{attrs:{\"title\":'好评（' + _vm.commentPraise + '）',\"name\":\"10\"}}),_c('van-tab',{attrs:{\"title\":'中评（' + _vm.commentReview + '）',\"name\":\"20\"}}),_c('van-tab',{attrs:{\"title\":'差评（' + _vm.commentNegative + '）',\"name\":\"30\"}})],1),_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\"},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.commentList),function(item,index){return _c('CommentItem',{key:index,attrs:{\"commentItem\":item}})}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import requestUtil from '@/utils/request'\r\n\r\n// 获取评价列表\r\nexport const getCommentListApi = (goodsId, scoreType, page) => {\r\n  return requestUtil({\r\n    url: '/comment/list',\r\n    params: {\r\n      goodsId,\r\n      scoreType,\r\n      page\r\n    }\r\n  })\r\n}\r\n\r\n// 获取评论数 - 好评 中评 差评\r\nexport const getCommentNumApi = (goodsId) => {\r\n  return requestUtil({\r\n    url: '/comment/total',\r\n    params: {\r\n      goodsId\r\n    }\r\n  })\r\n}\r\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"comment-item\"},[_c('div',{staticClass:\"top\"},[_c('img',{attrs:{\"src\":_vm.commentItem.user.avatar_url || _vm.defaultAvatar,\"alt\":\"\"}}),_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.commentItem.user.nick_name))]),_c('van-rate',{attrs:{\"size\":16,\"value\":_vm.scoreRate(_vm.commentItem.score),\"color\":\"#ffd21e\",\"void-icon\":\"star\",\"void-color\":\"#eee\"}})],1),_c('div',{staticClass:\"content\"},[_vm._v(\" \"+_vm._s(_vm.commentItem.content)+\" \")]),(_vm.commentItem.is_picture)?_c('div',_vm._l((_vm.commentItem.images),function(item,index){return _c('img',{key:index,staticClass:\"userImg-small\",attrs:{\"src\":item.image_url,\"alt\":\"\"},on:{\"click\":function($event){return _vm.showBigImg(index)}}})}),0):_vm._e(),_c('van-popup',{model:{value:(_vm.isShowBigImg),callback:function ($$v) {_vm.isShowBigImg=$$v},expression:\"isShowBigImg\"}},[_c('img',{staticClass:\"userImg-large\",attrs:{\"src\":_vm.clickedImg_url,\"alt\":\"\"}})]),_c('div',{staticClass:\"time\"},[_vm._v(\" \"+_vm._s(_vm.commentItem.create_time)+\" \")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"comment-item\">\r\n    <div class=\"top\">\r\n      <img :src=\"commentItem.user.avatar_url || defaultAvatar\" alt=\"\" />\r\n      <div class=\"name\">{{ commentItem.user.nick_name }}</div>\r\n      <van-rate\r\n        :size=\"16\"\r\n        :value=\"scoreRate(commentItem.score)\"\r\n        color=\"#ffd21e\"\r\n        void-icon=\"star\"\r\n        void-color=\"#eee\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"content\">\r\n      {{ commentItem.content }}\r\n    </div>\r\n    <div v-if=\"commentItem.is_picture\">\r\n      <img\r\n        v-for=\"(item, index) in commentItem.images\"\r\n        :key=\"index\"\r\n        :src=\"item.image_url\"\r\n        alt=\"\"\r\n        @click=\"showBigImg(index)\"\r\n        class=\"userImg-small\"\r\n      />\r\n    </div>\r\n\r\n    <!-- 点击显示大图 -->\r\n    <van-popup v-model=\"isShowBigImg\">\r\n      <img :src=\"clickedImg_url\" alt=\"\" class=\"userImg-large\" />\r\n    </van-popup>\r\n\r\n    <div class=\"time\">\r\n      {{ commentItem.create_time }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport defaultAvatar from '@/assets/default-avatar.png'\r\n\r\nexport default {\r\n  name: 'CommentItem',\r\n\r\n  data () {\r\n    return {\r\n      defaultAvatar,\r\n      isShowBigImg: false,\r\n      clickedImg_url: ''\r\n    }\r\n  },\r\n\r\n  props: {\r\n    commentItem: {\r\n      required: true\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // 根据score返回星数\r\n    scoreRate (score) {\r\n      if (score === 10) {\r\n        return 5\r\n      } else if (score === 20) {\r\n        return 3\r\n      } else if (score === 30) {\r\n        return 1\r\n      } else {\r\n        return 0\r\n      }\r\n    },\r\n\r\n    // 展示大图\r\n    showBigImg (index) {\r\n      this.isShowBigImg = true\r\n      this.clickedImg_url = this.commentItem.images[index].image_url\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.comment-item {\r\n  font-size: 16px;\r\n  line-height: 30px;\r\n  .top {\r\n    height: 30px;\r\n    display: flex;\r\n    align-items: center;\r\n    margin-top: 20px;\r\n    img {\r\n      width: 20px;\r\n      height: 20px;\r\n    }\r\n    .name {\r\n      margin: 0 10px;\r\n    }\r\n  }\r\n  .time {\r\n    color: #999;\r\n  }\r\n  .userImg-small {\r\n    width: 75px;\r\n  }\r\n  .userImg-large {\r\n    width: 375px;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommentItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommentItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CommentItem.vue?vue&type=template&id=54f50818&scoped=true&\"\nimport script from \"./CommentItem.vue?vue&type=script&lang=js&\"\nexport * from \"./CommentItem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CommentItem.vue?vue&type=style&index=0&id=54f50818&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"54f50818\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"container\">\r\n    <van-nav-bar fixed title=\"商品评价\" left-arrow @click-left=\"$router.back()\">\r\n    </van-nav-bar>\r\n\r\n    <van-tabs v-model=\"activeName\" @click=\"changeTab\" sticky>\r\n      <van-tab :title=\"'全部（' + commentAll + '）'\" name=\"-1\"></van-tab>\r\n      <van-tab :title=\"'好评（' + commentPraise + '）'\" name=\"10\"></van-tab>\r\n      <van-tab :title=\"'中评（' + commentReview + '）'\" name=\"20\"></van-tab>\r\n      <van-tab :title=\"'差评（' + commentNegative + '）'\" name=\"30\"></van-tab>\r\n    </van-tabs>\r\n\r\n    <van-list\r\n      v-model=\"loading\"\r\n      :finished=\"finished\"\r\n      finished-text=\"没有更多了\"\r\n      @load=\"onLoad\"\r\n    >\r\n      <CommentItem\r\n        v-for=\"(item, index) in commentList\"\r\n        :key=\"index\"\r\n        :commentItem=\"item\"\r\n      ></CommentItem>\r\n    </van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getCommentListApi, getCommentNumApi } from '@/api/comment'\r\nimport CommentItem from '@/components/CommentItem.vue'\r\n\r\nexport default {\r\n  name: 'CommentList',\r\n  components: {\r\n    CommentItem\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      activeName: -1,\r\n      goodsId: this.$route.query.goodsId,\r\n      //   scoreType: -1,\r\n      // -1 全部 10 好评 20 中评 30 差评\r\n      page: 1,\r\n\r\n      commentData: {},\r\n      commentList: [],\r\n\r\n      loading: false,\r\n      finished: false,\r\n\r\n      commentAll: 0,\r\n      commentPraise: 0,\r\n      commentReview: 0,\r\n      commentNegative: 0\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    async getCommentList () {\r\n      const { data: { list } } = await getCommentListApi(this.goodsId, this.activeName, this.page)\r\n      // console.log(list)\r\n      this.commentData = list\r\n      // 新加载的评论与之前的评论合并\r\n      this.commentList = this.commentList.concat(list.data)\r\n      this.loading = false\r\n      this.page++\r\n      if (this.commentList.length >= this.commentData.total) {\r\n        this.finished = true\r\n      }\r\n    },\r\n\r\n    async onLoad () {\r\n      await this.getCommentList()\r\n    },\r\n\r\n    async changeTab (name) {\r\n      this.activeName = name\r\n      this.commentData = {}\r\n      this.commentList = []\r\n      this.page = 1\r\n      this.loading = true\r\n      this.finished = false\r\n      await this.onLoad()\r\n    },\r\n\r\n    async getCommentNum () {\r\n      const { data: { total } } = await getCommentNumApi(this.goodsId)\r\n      this.commentAll = total.all\r\n      this.commentPraise = total.praise\r\n      this.commentReview = total.review\r\n      this.commentNegative = total.negative\r\n    }\r\n\r\n  },\r\n\r\n  created () {\r\n    this.getCommentNum()\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.container {\r\n  padding: 48px 21px;\r\n}\r\n.van-tabs {\r\n  position: sticky;\r\n  top: 46px;\r\n  z-index: 999;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=2e05097b&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=2e05097b&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2e05097b\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","$event","$router","back","changeTab","model","value","activeName","callback","$$v","expression","commentAll","commentPraise","commentReview","commentNegative","finished","onLoad","loading","_l","commentList","item","index","key","staticRenderFns","getCommentListApi","goodsId","scoreType","page","requestUtil","url","params","getCommentNumApi","commentItem","user","avatar_url","defaultAvatar","_v","_s","nick_name","scoreRate","score","content","is_picture","images","image_url","showBigImg","_e","isShowBigImg","clickedImg_url","create_time","name","data","props","required","methods","component","components","CommentItem","$route","query","commentData","getCommentList","list","concat","length","total","getCommentNum","all","praise","review","negative","created"],"sourceRoot":""}