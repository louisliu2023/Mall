"use strict";(self["webpackChunkshopvue"]=self["webpackChunkshopvue"]||[]).push([[110],{8489:function(t,e,r){r.d(e,{Z:function(){return l}});var a=function(){var t=this,e=t._self._c;return e("van-action-sheet",{attrs:{title:"支付订单",closeable:"",round:"",value:t.isPayAction},on:{"click-overlay":t.sendClose,cancel:t.sendClose}},[e("van-radio-group",{attrs:{"checked-color":"#ee0a24"},model:{value:t.payType,callback:function(e){t.payType=e},expression:"payType"}},[e("van-cell-group",[e("van-cell",{attrs:{clickable:""},on:{click:function(e){t.payType="10"}},scopedSlots:t._u([{key:"title",fn:function(){return[e("van-icon",{attrs:{name:"balance-o",color:"#ff9700"}}),e("span",[t._v("余额支付")])]},proxy:!0},{key:"right-icon",fn:function(){return[e("van-radio",{attrs:{name:"10"}})]},proxy:!0}])}),e("van-cell",{attrs:{clickable:""},on:{click:function(e){t.payType="0"}},scopedSlots:t._u([{key:"title",fn:function(){return[e("van-icon",{attrs:{name:"info-o",color:"#ee0a24"}}),e("span",[t._v("微信支付")])]},proxy:!0},{key:"right-icon",fn:function(){return[e("van-radio",{attrs:{name:"0"}})]},proxy:!0}])})],1)],1),e("div",{staticClass:"btn now",on:{click:function(e){return t.toPayOrder(t.orderData.order_id,+t.payType)}}},[t._v("立即付款")])],1)},n=[],i=r(7334),o={name:"PayActionSheet",mixins:[i.Z],props:{isPayAction:{required:!0,type:Boolean},orderData:{type:Object}},data(){return{payType:"10"}},methods:{sendClose(){this.$emit("closeSheet",!1)}}},s=o,d=r(1001),c=(0,d.Z)(s,a,n,!1,null,"ae3894a6",null),l=c.exports},5110:function(t,e,r){r.r(e),r.d(e,{default:function(){return _}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order"},[e("van-nav-bar",{attrs:{fixed:"",title:"我的订单","left-arrow":""},on:{"click-left":function(e){return t.$router.back()}}}),e("van-tabs",{attrs:{sticky:""},on:{click:t.changeTab},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("van-tab",{attrs:{title:"全部",name:"all"}}),e("van-tab",{attrs:{title:"待支付",name:"payment"}}),e("van-tab",{attrs:{title:"待发货",name:"delivery"}}),e("van-tab",{attrs:{title:"待收货",name:"received"}}),e("van-tab",{attrs:{title:"待评价",name:"comment"}})],1),e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.loadOrder},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.orderList,(function(t,r){return e("OrderListItem",{key:r,attrs:{everyOrder:t}})})),1)],1)},n=[],i=(r(7658),function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-list-item"},[e("div",{staticClass:"tit"},[e("div",{staticClass:"time"},[t._v(t._s(t.everyOrder.create_time))]),e("div",{staticClass:"status"},[e("span",[t._v(t._s(t.everyOrder.state_text))])])]),e("div",{staticClass:"list",on:{click:function(e){return t.$router.push(`/orderdetail?orderId=${t.everyOrder.order_id}`)}}},t._l(t.goods,(function(r,a){return e("div",{key:a,staticClass:"list-item"},[e("div",{staticClass:"goods-img"},[e("img",{attrs:{src:r.goods_image,alt:""}})]),e("div",{staticClass:"goods-content text-ellipsis-2"},[t._v(" "+t._s(r.goods_name)+" ")]),e("div",{staticClass:"goods-trade"},[e("p",[t._v("¥ "+t._s(r.total_pay_price))]),e("p",[t._v("x "+t._s(r.total_num))])])])})),0),e("div",{staticClass:"total"},[t._v(" 共"+t._s(t.everyOrder.goods.length)+"件商品，总金额 ¥"+t._s(t.everyOrder.total_price)+" ")]),e("div",{staticClass:"actions"},[10===t.everyOrder.order_status?e("div",[10===t.everyOrder.pay_status?e("span",{staticClass:"action-red",on:{click:function(e){e.stopPropagation(),t.isPayAction=!0}}},[t._v("立刻付款")]):t._e(),10===t.everyOrder.delivery_status?e("span",{on:{click:function(e){return t.toCancelOrder(t.everyOrder.order_id)}}},[t._v("取消订单")]):t._e(),20===t.everyOrder.delivery_status?e("span",{staticClass:"action-red",on:{click:function(e){return t.toConfirmReceipt(t.everyOrder.order_id)}}},[t._v("确认收货")]):t._e()]):t._e(),30===t.everyOrder.order_status?e("div",[e("span",{on:{click:function(e){return t.$router.push(`/addcomment?orderId=${t.everyOrder.order_id}`)}}},[t._v("评价")])]):t._e()]),e("PayAction",{attrs:{isPayAction:t.isPayAction,orderData:t.everyOrder},on:{closeSheet:t.handleClose}})],1)}),o=[],s=r(7334),d=r(8489),c={name:"OrderListItem",mixins:[s.Z],components:{PayAction:d.Z},props:{everyOrder:{required:!0}},data(){return{isPayAction:!1}},computed:{goods(){return this.everyOrder.goods}},methods:{handleClose(t){this.isPayAction=t}}},l=c,u=r(1001),v=(0,u.Z)(l,i,o,!1,null,"9e88b4b8",null),p=v.exports,y=r(2933),m={name:"OrderIndex",components:{OrderListItem:p},data(){return{page:1,activeName:this.$route.query.dataType||"all",loading:!1,finished:!1,orderList:[]}},computed:{},methods:{async changeTab(t){this.activeName=t,this.page=1,this.loading=!0,this.finished=!1,this.orderList=[],await this.loadOrder(),this.$router.replace(`myorder?dataType=${t}`)},async loadOrder(){await this.getOrderList()},async getOrderList(){const{data:{list:t}}=await(0,y.l$)(this.activeName,this.page);this.orderList=this.orderList.concat(t.data),this.loading=!1,this.page++,this.orderList.length>=t.total&&(this.finished=!0)}},created(){}},h=m,f=(0,u.Z)(h,a,n,!1,null,"75eb81ef",null),_=f.exports},2933:function(t,e,r){r.d(e,{F1:function(){return i},KH:function(){return c},N1:function(){return u},RH:function(){return l},WC:function(){return s},eN:function(){return d},l$:function(){return n},rC:function(){return o}});var a=r(4471);const n=(t,e)=>(0,a.Z)({url:"/order/list",params:{dataType:t,page:e}}),i=t=>(0,a.Z)({method:"post",url:"/order/cancel",data:{orderId:t}}),o=(t,e)=>(0,a.Z)({url:"/order/pay",params:{orderId:t,payType:e}}),s=t=>(0,a.Z)({method:"post",url:"/order/receipt",data:{orderId:t}}),d=t=>(0,a.Z)({url:"/order.comment/list",params:{orderId:t}}),c=t=>(0,a.Z)({method:"post",url:"/upload/image",data:t}),l=(t,e)=>(0,a.Z)({method:"post",url:"/order.comment/submit",data:{orderId:t,form:e}}),u=t=>(0,a.Z)({url:"/order/detail",params:{orderId:t}})},7334:function(t,e,r){var a=r(2933);e.Z={methods:{toCancelOrder(t){this.$dialog.confirm({message:"确定要取消订单吗"}).then((async()=>{await(0,a.F1)(t),this.$router.go(0)})).catch((()=>{}))},async toPayOrder(t,e){await(0,a.rC)(t,e),this.$toast("支付成功"),this.$router.go(0)},toConfirmReceipt(t){this.$dialog.confirm({message:"您确定已经收到货了吗"}).then((async()=>{await(0,a.WC)(t),this.$toast("确认收货成功"),this.$router.go(0)})).catch((()=>{}))}}}}}]);
//# sourceMappingURL=110.9e18cdde.js.map